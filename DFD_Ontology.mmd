flowchart LR
  %% Focus: Ontology & Knowledge Base (Fuseki)
  subgraph Actors[Actors]
    M((Manufacturer))
    D((Distributor))
    P((Pharmacy))
    Eval((Evaluator Service))
  end

  subgraph KB[Ontology & Triple Store]
    Fuseki[[Fuseki SPARQL Endpoint]]
    Ont[(pharma-trust.owl)]
    G[Trust Graph RDF]
  end

  %% Data ingestion
  M --> Fuseki
  D --> Fuseki
  P --> Fuseki

  %% Reasoning & queries
  Ont --> Fuseki
  Fuseki --> G
  Eval --> Fuseki
  G --> Eval

  %% Threat markers
  classDef attack fill:#ffcccc,stroke:#ff0000,stroke-width:1px;
  classDef layer fill:#eef6ff,stroke:#003366,stroke-width:0.8px;
  class KB,Actors layer;
  class Fuseki,Ont attack;

  %% Annotations
  Fuseki -.-> Fuseki_note["⚠ SPARQL injection / query bombs / Unauthorized writes / Inference leakage (linkability)"]
  Ont -.-> Ont_note["⚠ Ontology tampering / semantic drift"]
